(function(a){a.fn.iframeOverlay=function(m){var c;var b=0;var d=a.extend({wrapper:"#embed-wrapper",wrapperTop:0,wrapperLeft:0,wrapperBottom:0,wrapperRight:0,defWidth:610,defHeight:712,overlay:"#overlay",closeOverlay:"#close-overlay",closeOverlayPos:"iframe-top-right",href:"",prevId:"#previous",nextId:"#next",nextHref:"",prevHref:"",dataItem:0,startDims:0,controls:".controls",videoClass:".video-thumb",videoThumbTempSel:"#video-thumb-template"},m);var e=0;var g=[];a(this).each(function(){a(this).attr("data-item",e);g[e]=a(this);e++});d.max=g.length-1;a(this).each(function(){a(this).on("click",function(){d.href=a(this).attr("href");d.dataItem=a(this).attr("data-item");handleOverlay();return false})});var j=a(d.videoThumbTempSel).html();closeOverlay=function(){a(d.closeOverlay).on("click",function(){a(d.overlay).fadeOut(300,function(){emptyWrapper()})});a(d.overlay).on("click",function(){a(this).fadeOut(300,function(){emptyWrapper()})});a(d.nextId).css({display:"none"});a(d.prevId).css({display:"none"});f()};function f(){clearInterval(c)}showOverlay=function(){a(d.overlay).fadeIn(300);c=setInterval(function(){handleResize()},300)};handleResize=function(){bw=a("body").width();bh=a("body").height();currDims=bw*bh;if(currDims!=d.startDims){a(d.controls).hide();sizeWrapper()}};sizeWrapper=function(){bw=a("body").width();bh=a("body").height();d.startDims=bw*bh;d.wrapperWidth=(bw>d.defWidth)?d.defWidth:bw;d.defHeight=d.wrapperWidth+100;d.wrapperHeight=(bh>d.defHeight)?d.defHeight:bh+100;a(d.overlay).css({width:"100%","min-height":"100%"});d.wrapperWidth*=0.85;d.wrapperHeight*=0.85;a(d.wrapper).animate({width:d.wrapperWidth,height:d.wrapperHeight},1,function(){positionWrapper()})};videoIndicator=function(){a(d.videoClass).each(function(){w=a(this).find("img").width();h=a(this).find("img").height();imgSrc=a(this).find("img").attr("src");a(this).children("a").children("img").remove();a(this).children("a").html(j);a(this).css({width:w,height:h,background:"url("+imgSrc+") no-repeat center center"})})};positionWrapper=function(){w=a(d.wrapper).width();h=a(d.wrapper).height();bw=a("body").width();bh=a("body").height();t=((bh-h)>0)?(bh-h)/2:0;l=((bw-w)>0)?(bw-w)/2:0;a(d.wrapper).animate({"margin-top":t,"margin-left":l},1,function(){d.wrapperTop=t;d.wrapperLeft=l;d.wrapperBottom=t+d.wrapperHeight;d.wrapperRight=l+d.wrapperWidth;setTimeout(function(){positionPrevNext();positionCloseOverlay()},900)})};positionPrevNext=function(){bh=a("body").height();bw=a("body").width();d.defHeight=w+100;h=a(d.nextId).height();t=(bh-h)/2;l=((bw-d.wrapperWidth)/2)-(h*1);if(l<(h*2)){l=h*2}a(d.nextId).css({display:"block",position:"absolute",top:t,left:l});a(d.prevId).css({display:"block",position:"absolute",top:t,right:l})};positionCloseOverlay=function(){switch(d.closeOverlayPos){default:clsHeight=a(d.closeOverlay).height();clsT=d.wrapperTop-(clsHeight*0.5);clsL=d.wrapperLeft+d.wrapperWidth-(clsHeight*0.4);a(d.closeOverlay).animate({top:clsT,left:clsL},1,function(){a(d.controls).fadeIn(300)});break}};newIframe=function(){html='<iframe src="'+d.href+'" frameborder="0" scrolling="no" allowtransparency="true" onload="" autoplay></iframe>';a(d.wrapper).html(html);return false};emptyWrapper=function(){a(d.wrapper).html("")};function k(){a(d.wrapper).fadeIn(1300)}prevNextHandler=function(){a(d.nextId).on("click",function(){d.dataItem--;if(d.dataItem<0){d.dataItem=(g.length-1)}d.href=a(g[d.dataItem]).attr("href");newIframe();return false});a(d.prevId).on("click",function(){d.dataItem++;if(d.dataItem>(g.length-1)){d.dataItem=0}d.href=a(g[d.dataItem]).attr("href");newIframe();return false})};handleOverlay=function(n){var i;sizeWrapper();closeOverlay();newIframe();showOverlay()};videoIndicator();prevNextHandler();a("body").on("scroll",function(){})}})(jQuery);