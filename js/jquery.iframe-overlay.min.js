(function(a){a.fn.iframeOverlay=function(e){var g;var f=a.extend({wrapper:"#embed-wrapper",wrapperTop:0,wrapperLeft:0,wrapperBottom:0,wrapperRight:0,defWidth:610,defHeight:712,overlay:"#overlay",closeOverlay:"#close-overlay",closeOverlayPos:"iframe-top-right",href:"",prevId:"#previous",nextId:"#next",dataItem:0,startDims:0,controls:".controls",video:true,videoClass:".thumb-video",videoThumbTempSel:"#video-thumb-template"},e);var b=[];i=0;a(this).each(function(){a(this).attr("data-item",i);b[i]=a(this);i++});f.max=b.length-1;a(this).each(function(){a(this).on("click",function(){f.href=a(this).attr("href");f.dataItem=a(this).attr("data-item");handleOverlay();return false})});if(f.video===true){var d=a(f.videoThumbTempSel).html()}closeOverlay=function(){a(f.closeOverlay).on("click",function(){a(f.overlay).fadeOut(300,function(){emptyWrapper()})});a(f.overlay).on("click",function(){a(this).fadeOut(300,function(){emptyWrapper()})});a(f.nextId).css({display:"none"});a(f.prevId).css({display:"none"});c()};function c(){clearInterval(g)}showOverlay=function(){a(f.overlay).fadeIn(300);g=setInterval(function(){handleResize()},300)};handleResize=function(){bw=a("body").width();bh=a("body").height();currDims=bw*bh;if(currDims!=f.startDims){a(f.controls).hide();sizeWrapper()}};sizeWrapper=function(){bw=a("body").width();bh=a("body").height();f.startDims=bw*bh;f.wrapperWidth=(bw>f.defWidth)?f.defWidth:bw;f.defHeight=f.wrapperWidth+100;f.wrapperHeight=(bh>f.defHeight)?f.defHeight:bh+100;a(f.overlay).css({width:"100%","min-height":"100%"});f.wrapperWidth*=0.85;f.wrapperHeight*=0.85;a(f.wrapper).animate({width:f.wrapperWidth,height:f.wrapperHeight},1,function(){positionWrapper()})};videoIndicator=function(){a(f.videoClass).each(function(){if(false===a(this).hasClass("rendered")){w=a(this).find("img").width();h=a(this).find("img").height();imgSrc=a(this).find("img").attr("src");a(this).children("a").children("img").remove();a(this).children("a").html(d);a(this).css({width:w,height:h,background:"url("+imgSrc+") no-repeat center center"});a(this).addClass("rendered")}})};positionWrapper=function(){w=a(f.wrapper).width();h=a(f.wrapper).height();bw=a("body").width();bh=a("body").height();t=((bh-h)>0)?(bh-h)/2:0;l=((bw-w)>0)?(bw-w)/2:0;a(f.wrapper).animate({"margin-top":t,"margin-left":l},1,function(){f.wrapperTop=t;f.wrapperLeft=l;f.wrapperBottom=t+f.wrapperHeight;f.wrapperRight=l+f.wrapperWidth;setTimeout(function(){positionPrevNext();positionCloseOverlay()},900)})};positionPrevNext=function(){bh=a("body").height();bw=a("body").width();f.defHeight=w+100;h=a(f.nextId).height();t=(bh-h)/2;l=((bw-f.wrapperWidth)/2)-(h*1);if(l<(h*2)){l=h*2}a(f.nextId).css({display:"block",position:"absolute",top:t,left:l});a(f.prevId).css({display:"block",position:"absolute",top:t,right:l})};positionCloseOverlay=function(){switch(f.closeOverlayPos){default:clsHeight=a(f.closeOverlay).height();clsT=f.wrapperTop-(clsHeight*0.5);clsL=f.wrapperLeft+f.wrapperWidth-(clsHeight*0.4);a(f.closeOverlay).animate({top:clsT,left:clsL},1,function(){a(f.controls).fadeIn(300)});break}};newIframe=function(){html='<iframe src="'+f.href+'" frameborder="0" scrolling="no" allowtransparency="true" onload="" autoplay></iframe>';a(f.wrapper).html(html);return false};emptyWrapper=function(){a(f.wrapper).html("")};prevNextHandler=function(){a(f.nextId).on("click",function(){f.dataItem--;if(f.dataItem<0){f.dataItem=(b.length-1)}f.href=a(b[f.dataItem]).attr("href");newIframe();return false});a(f.prevId).on("click",function(){f.dataItem++;if(f.dataItem>(b.length-1)){f.dataItem=0}f.href=a(b[f.dataItem]).attr("href");newIframe();return false})};handleOverlay=function(j){sizeWrapper();closeOverlay();newIframe();showOverlay()};if(f.video===true){videoIndicator()}prevNextHandler();a("body").on("scroll",function(){})}})(jQuery);